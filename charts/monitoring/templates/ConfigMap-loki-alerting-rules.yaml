apiVersion: v1
kind: ConfigMap
metadata:
  name: loki-alerting-rules
  namespace: {{ include "externalsecrets.namespace" . }}
  labels:
    release: monitoring-metrics
data:
  rules.yaml: |
    groups:
      - name: test_alert
        rules:
          - alert: TestAlert
            expr: sum(rate({app="loki"} | logfmt | level="info"[1m])) by (container) > 0
            for: 1m
            labels:
                severity: warning
            annotations:
                summary: Loki info warning per minute rate > 0
                message: 'Loki warning per minute rate > 0 container:"{{`{{`}} $labels.container {{`}}`}}"'
